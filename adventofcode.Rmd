---
title: "Advent Of Code"
author: "Issa Sanogo"
date: '`r format(Sys.Date(), "%d/%m/%Y")`'
output: html_document
---

```{r setup, include=FALSE}
# Options
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
options(stringsAsFactors = FALSE)

# Packages
library(tidyverse)
library(glue)
```

# AOC 2020

## --- Day 1 : Report Repair ---

```{r day1-input}
# read the input
input <- readLines("./data/2020/day1-input.txt")
```

### Part One

```{r part one}
two_entrie <- combn(input, 2) %>% # create a matrix of possible
  as_tibble() %>%
  map_df(as.numeric)
two_entrie <- unlist(two_entrie[colSums(two_entrie) == 2020], use.names = FALSE)
# two_entrie
# sum(two_entrie)
# prod(two_entrie)
```

In my list, the two entries that sum to `2020` are `r paste(two_entrie, collapse = " and ")`.
Multiplying them together produces `r paste(two_entrie, collapse = " * ")` = `r as.character(prod(two_entrie))`.

### Part Two

```{r part two}
three_entrie <- combn(input, 3) %>%
  as_tibble() %>%
  map_df(as.numeric)
three_entrie <- unlist(three_entrie[colSums(three_entrie) == 2020], use.names = FALSE)
# three_entrie
# sum(three_entrie)
# prod(three_entrie)
```

In my list, the three entries that sum to `2020` are `r glue_collapse(three_entrie, ", ", last = ", and ")`. Multiplying them together produces `r paste(three_entrie,  collapse = " * ")` = `r as.character(prod(three_entrie))`.

## --- Day 2: Password Philosophy ---

```{r day2-input}
# read the input
input <- readLines("./data/2020/day2-input.txt")
```

```{r part One}
valid_passwd <- str_split(input, pattern = ":\\s", simplify = TRUE) %>% 
  as_tibble() %>% 
  set_names(c("policy", "passwd")) %>% 
  separate(policy, into = c("min", "max"), sep = "-") %>% 
  separate(max, into = c("max", "letter"), sep = "\\s") %>% 
  mutate(N = str_count(passwd, pattern = letter),
         min = as.numeric(min),
         max = as.numeric(max))
res <- table(valid_passwd$N >= valid_passwd$min & valid_passwd$N <= as.numeric(valid_passwd$max))
```

In my list, `r res[2]` passwords are valid according to their policies.

```{r part Two}
res <- valid_passwd %>%
  mutate(pos1 = str_sub(passwd, min, min),
         pos2 = str_sub(passwd, max, max),
         pos1_verif = pos1 == letter,
         pos2_verif = pos2 == letter,
         verif = pos1_verif + pos2_verif) %>%
  pull(verif) %>% 
  table()
```
In my list, `r res[2]` passwords are valid according to the new interpretation of the policies.

## --- Day 3: Toboggan Trajectory ---
