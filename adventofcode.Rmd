---
title: "Advent Of Code"
author: "Issa Sanogo"
date: '`r format(Sys.Date(), "%d/%m/%Y")`'
output: html_document
---

```{r setup, include=FALSE}
# Options
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
options(stringsAsFactors = FALSE)

# Packages
library(tidyverse)
library(glue)
```

# AOC 2020

## --- Day 1 : Report Repair ---

```{r day1-input}
# read the input
input <- readLines("./data/2020/day1-input.txt")
```

### Part One

```{r part one}
two_entrie <- combn(input, 2) %>% # create a matrix of possible
  as_tibble() %>%
  map_df(as.numeric)
two_entrie <- unlist(two_entrie[colSums(two_entrie) == 2020], use.names = FALSE)
# two_entrie
# sum(two_entrie)
# prod(two_entrie)
```

In my list, the two entries that sum to `2020` are `r paste(two_entrie, collapse = " and ")`.
Multiplying them together produces `r paste(two_entrie, collapse = " * ")` = `r as.character(prod(two_entrie))`.

### Part Two

```{r part two}
three_entrie <- combn(input, 3) %>%
  as_tibble() %>%
  map_df(as.numeric)
three_entrie <- unlist(three_entrie[colSums(three_entrie) == 2020], use.names = FALSE)
# three_entrie
# sum(three_entrie)
# prod(three_entrie)
```

In my list, the three entries that sum to `2020` are `r glue_collapse(three_entrie, ", ", last = ", and ")`. Multiplying them together produces `r paste(three_entrie,  collapse = " * ")` = `r as.character(prod(three_entrie))`.

## --- Day 2: Password Philosophy ---

```{r day2-input}
# read the input
input <- readLines("./data/2020/day2-input.txt")
```

```{r part one}
valid_passwd <- str_split(input, pattern = ":\\s", simplify = TRUE) %>% 
  as_tibble() %>% 
  set_names(c("policy", "passwd")) %>% 
  separate(policy, into = c("min", "max"), sep = "-") %>% 
  separate(max, into = c("max", "letter"), sep = "\\s") %>% 
  mutate(N = str_count(passwd, pattern = letter),
         min = as.numeric(min),
         max = as.numeric(max))
res <- sum(valid_passwd$N >= valid_passwd$min & valid_passwd$N <= as.numeric(valid_passwd$max))
res
```

In my list, `r res` passwords are valid according to their policies.

```{r part two}
res <- valid_passwd %>%
  mutate(pos1 = str_sub(passwd, min, min),
         pos2 = str_sub(passwd, max, max),
         pos1_verif = pos1 == letter,
         pos2_verif = pos2 == letter,
         verif = pos1_verif + pos2_verif) %>%
  pull(verif)
res <- sum(res == 1)
res
```
In my list, `r res` passwords are valid according to the new interpretation of the policies.

## --- Day 3: Toboggan Trajetory ---

```{r day3-input}
# read the input
input <- readLines("./data/2020/day3-input.txt")
trajet <- str_split(input, pattern = "")

# Function to traverse the forest
traverse <- function (right, down) {
  trajet <- trajet[seq(1, length(input), down)]
  pos <- cumsum(rep(right, times = length(trajet) - 1 )) + 1
  pos <- c(1, pos)
  while (any(pos > 31))  pos[pos > 31] <- pos[pos > 31] - 31
  res <- sapply(seq_along(pos), function(x) trajet[[x]][pos[x]])
  sum(res == "#") 
}
```

```{r part one}
res <- traverse(3, 1)
res
```

In my list, I'll encounter `r res` trees.

```{r part one}
res <- traverse(1, 1) * traverse(3, 1) * traverse(5, 1) * traverse(7, 1) * traverse(1, 2)
res
```

I get `r res` when I multiply together the number of trees encountered on each of the listed slopes.
